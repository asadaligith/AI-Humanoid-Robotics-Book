"use strict";(self.webpackChunkai_humanoid_robotics_book=self.webpackChunkai_humanoid_robotics_book||[]).push([[920],{5629:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"modules/module-01-ros2-fundamentals/chapter-04-services","title":"Chapter 4: Services for Synchronous Communication","description":"Implement request-response patterns using ROS 2 services for on-demand robot queries","source":"@site/docs/modules/module-01-ros2-fundamentals/chapter-04-services.md","sourceDirName":"modules/module-01-ros2-fundamentals","slug":"/modules/module-01-ros2-fundamentals/chapter-04-services","permalink":"/docs/modules/module-01-ros2-fundamentals/chapter-04-services","draft":false,"unlisted":false,"editUrl":"https://github.com/asadaligith/AI-Humanoid-Robotics-Book/tree/main/docs/modules/module-01-ros2-fundamentals/chapter-04-services.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Chapter 4: Services for Synchronous Communication","description":"Implement request-response patterns using ROS 2 services for on-demand robot queries","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"3\ufe0f\u20e3 ROS 2 Packages","permalink":"/docs/modules/module-01-ros2-fundamentals/chapter-03-packages"},"next":{"title":"5\ufe0f\u20e3 Actions","permalink":"/docs/modules/module-01-ros2-fundamentals/chapter-05-actions"}}');var i=s(4848),t=s(8453);const o={title:"Chapter 4: Services for Synchronous Communication",description:"Implement request-response patterns using ROS 2 services for on-demand robot queries",sidebar_position:4},c="Chapter 4: Services for Synchronous Communication",l={},a=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Introduction",id:"introduction",level:2},{value:"When to Use Services",id:"when-to-use-services",level:2},{value:"Service Server Example",id:"service-server-example",level:2},{value:"Service Client Example",id:"service-client-example",level:2},{value:"Custom Service Definitions",id:"custom-service-definitions",level:2},{value:"Testing Services",id:"testing-services",level:2},{value:"Exercise",id:"exercise",level:2},{value:"Summary",id:"summary",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",strong:"strong",sup:"sup",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"chapter-4-services-for-synchronous-communication",children:"Chapter 4: Services for Synchronous Communication"})}),"\n",(0,i.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,i.jsx)(n.p,{children:"By the end of this chapter, you will be able to:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Create"})," ROS 2 service servers to handle requests"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Implement"})," service clients to make synchronous calls"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Design"})," custom service definitions for robotics tasks"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Apply"})," services for on-demand computations"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsxs)(n.p,{children:["Services provide synchronous request-response communication in ROS 2. Unlike topics, services guarantee a response and support bidirectional data flow",(0,i.jsx)(n.sup,{children:(0,i.jsx)(n.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"when-to-use-services",children:"When to Use Services"}),"\n",(0,i.jsxs)(n.p,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"Use services for"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Query operations (get robot status, request grasp pose)"}),"\n",(0,i.jsx)(n.li,{children:"On-demand computations (path planning, object recognition)"}),"\n",(0,i.jsx)(n.li,{children:"Configuration updates (set parameters, toggle modes)"}),"\n",(0,i.jsx)(n.li,{children:"Low-frequency requests (<1 Hz)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u274c ",(0,i.jsx)(n.strong,{children:"Avoid services for"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Continuous data streams (use topics)"}),"\n",(0,i.jsx)(n.li,{children:"Long-running tasks (use actions)"}),"\n",(0,i.jsx)(n.li,{children:"High-frequency calls (>10 Hz)"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"service-server-example",children:"Service Server Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from example_interfaces.srv import AddTwoInts\r\nimport rclpy\r\nfrom rclpy.node import Node\r\n\r\nclass AdditionServer(Node):\r\n    def __init__(self):\r\n        super().__init__('addition_server')\r\n        self.srv = self.create_service(\r\n            AddTwoInts,\r\n            'add_two_ints',\r\n            self.add_callback\r\n        )\r\n        self.get_logger().info('Addition service ready')\r\n\r\n    def add_callback(self, request, response):\r\n        response.sum = request.a + request.b\r\n        self.get_logger().info(f'Request: {request.a} + {request.b} = {response.sum}')\r\n        return response\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = AdditionServer()\r\n    rclpy.spin(node)\r\n    rclpy.shutdown()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"service-client-example",children:"Service Client Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from example_interfaces.srv import AddTwoInts\r\nimport rclpy\r\nfrom rclpy.node import Node\r\n\r\nclass AdditionClient(Node):\r\n    def __init__(self):\r\n        super().__init__('addition_client')\r\n        self.cli = self.create_client(AddTwoInts, 'add_two_ints')\r\n        while not self.cli.wait_for_service(timeout_sec=1.0):\r\n            self.get_logger().info('Waiting for service...')\r\n\r\n    def send_request(self, a, b):\r\n        req = AddTwoInts.Request()\r\n        req.a = a\r\n        req.b = b\r\n        future = self.cli.call_async(req)\r\n        return future\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = AdditionClient()\r\n    future = node.send_request(10, 20)\r\n    rclpy.spin_until_future_complete(node, future)\r\n    result = future.result()\r\n    node.get_logger().info(f'Result: {result.sum}')\r\n    rclpy.shutdown()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"custom-service-definitions",children:"Custom Service Definitions"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"File"}),": ",(0,i.jsx)(n.code,{children:"my_interfaces/srv/GetObjectPose.srv"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# Request\r\nstring object_id\r\n---\r\n# Response\r\ngeometry_msgs/Pose pose\r\nbool success\r\nstring message\n"})}),"\n",(0,i.jsx)(n.h2,{id:"testing-services",children:"Testing Services"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# List available services\r\nros2 service list\r\n\r\n# Call service from CLI\r\nros2 service call /add_two_ints example_interfaces/srv/AddTwoInts "{a: 5, b: 3}"\r\n\r\n# Show service type\r\nros2 service type /add_two_ints\n'})}),"\n",(0,i.jsx)(n.h2,{id:"exercise",children:"Exercise"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Task"}),': Create a "battery status" service where a client requests the current battery percentage, and the server responds with voltage, percentage, and health status.']}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Expected"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Request: Empty"}),"\n",(0,i.jsx)(n.li,{children:"Response: voltage (float), percentage (int), is_healthy (bool)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Code Example"}),": See ",(0,i.jsx)(n.code,{children:"examples/module-01-ros2-fundamentals/example-03-service/"})]}),"\n",(0,i.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(n.p,{children:"Services enable synchronous request-response communication for on-demand robotics tasks."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Next"}),": ",(0,i.jsx)(n.a,{href:"/docs/modules/module-01-ros2-fundamentals/chapter-05-actions",children:"Chapter 5: Actions for Long-Running Tasks"})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Estimated Reading Time"}),": 20 minutes\r\n",(0,i.jsx)(n.strong,{children:"Hands-On Time"}),": 35 minutes"]}),"\n","\n",(0,i.jsxs)(n.section,{"data-footnotes":!0,className:"footnotes",children:[(0,i.jsx)(n.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{id:"user-content-fn-1",children:["\n",(0,i.jsxs)(n.p,{children:['ROS 2 Documentation. "Understanding Services." ',(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Services/Understanding-ROS2-Services.html",children:"https://docs.ros.org/en/humble/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Services/Understanding-ROS2-Services.html"})," ",(0,i.jsx)(n.a,{href:"#user-content-fnref-1","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var r=s(6540);const i={},t=r.createContext(i);function o(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);