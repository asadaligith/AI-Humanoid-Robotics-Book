"use strict";(self.webpackChunkai_humanoid_robotics_book=self.webpackChunkai_humanoid_robotics_book||[]).push([[2987],{415:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"testing/integration-testing","title":"Integration Testing Guide","description":"Overview","source":"@site/docs/testing/integration-testing.md","sourceDirName":"testing","slug":"/testing/integration-testing","permalink":"/AI-Humanoid-Robotics-Book/docs/testing/integration-testing","draft":false,"unlisted":false,"editUrl":"https://github.com/asadaligith/AI-Humanoid-Robotics-Book/tree/main/docs/testing/integration-testing.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"API Integration Reference","permalink":"/AI-Humanoid-Robotics-Book/docs/integrations/api-reference"},"next":{"title":"Student Success Guide","permalink":"/AI-Humanoid-Robotics-Book/docs/community/student-guide"}}');var i=t(4848),r=t(8453);const o={},a="Integration Testing Guide",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Testing Levels",id:"testing-levels",level:2},{value:"ROS 2 Integration Testing",id:"ros-2-integration-testing",level:2},{value:"Test Framework Setup",id:"test-framework-setup",level:3},{value:"Example: Testing Publisher-Subscriber",id:"example-testing-publisher-subscriber",level:3},{value:"VLA Pipeline Integration Tests",id:"vla-pipeline-integration-tests",level:2},{value:"Test Whisper \u2192 LLM \u2192 Action Pipeline",id:"test-whisper--llm--action-pipeline",level:3},{value:"RAG Chatbot Integration Tests",id:"rag-chatbot-integration-tests",level:2},{value:"Test Document Retrieval and Response Generation",id:"test-document-retrieval-and-response-generation",level:3},{value:"Simulation Integration Tests",id:"simulation-integration-tests",level:2},{value:"Test Gazebo + ROS 2 Integration",id:"test-gazebo--ros-2-integration",level:3},{value:"Continuous Integration Tests",id:"continuous-integration-tests",level:2},{value:"GitHub Actions Workflow",id:"github-actions-workflow",level:3},{value:"Load Testing",id:"load-testing",level:2},{value:"Test API Performance",id:"test-api-performance",level:3},{value:"Test Coverage",id:"test-coverage",level:2},{value:"Generate Coverage Report",id:"generate-coverage-report",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"References",id:"references",level:2}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"integration-testing-guide",children:"Integration Testing Guide"})}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"Integration testing ensures that all course components work together correctly: ROS 2 nodes, simulation environments, VLA pipeline, and the RAG chatbot."}),"\n",(0,i.jsx)(n.h2,{id:"testing-levels",children:"Testing Levels"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Unit Tests \u2192 Integration Tests \u2192 System Tests \u2192 E2E Tests\n   \u2193              \u2193                   \u2193            \u2193\n Functions    Components         Full Stack    User Flows\n"})}),"\n",(0,i.jsx)(n.h2,{id:"ros-2-integration-testing",children:"ROS 2 Integration Testing"}),"\n",(0,i.jsx)(n.h3,{id:"test-framework-setup",children:"Test Framework Setup"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Install testing dependencies\nsudo apt install -y \\\n  ros-humble-launch-testing \\\n  ros-humble-launch-testing-ament-cmake \\\n  ros-humble-launch-testing-ros\n\npip3 install pytest pytest-timeout pytest-asyncio\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-testing-publisher-subscriber",children:"Example: Testing Publisher-Subscriber"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# test_pubsub_integration.py\nimport pytest\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\nimport threading\nimport time\n\nclass TestPubSubIntegration:\n    @classmethod\n    def setup_class(cls):\n        """Initialize ROS 2."""\n        rclpy.init()\n\n    @classmethod\n    def teardown_class(cls):\n        """Shutdown ROS 2."""\n        rclpy.shutdown()\n\n    def test_publisher_subscriber_communication(self):\n        """Test that publisher and subscriber can communicate."""\n\n        # Create test nodes\n        class TestPublisher(Node):\n            def __init__(self):\n                super().__init__(\'test_publisher\')\n                self.publisher = self.create_publisher(String, \'test_topic\', 10)\n                self.timer = self.create_timer(0.5, self.publish_message)\n\n            def publish_message(self):\n                msg = String()\n                msg.data = \'test_message\'\n                self.publisher.publish(msg)\n\n        class TestSubscriber(Node):\n            def __init__(self):\n                super().__init__(\'test_subscriber\')\n                self.subscription = self.create_subscription(\n                    String, \'test_topic\', self.callback, 10)\n                self.received_messages = []\n\n            def callback(self, msg):\n                self.received_messages.append(msg.data)\n\n        # Create nodes\n        publisher = TestPublisher()\n        subscriber = TestSubscriber()\n\n        # Spin in separate thread\n        executor = rclpy.executors.MultiThreadedExecutor()\n        executor.add_node(publisher)\n        executor.add_node(subscriber)\n\n        thread = threading.Thread(target=executor.spin, daemon=True)\n        thread.start()\n\n        # Wait for messages\n        time.sleep(2)\n\n        # Assert messages were received\n        assert len(subscriber.received_messages) > 0\n        assert subscriber.received_messages[0] == \'test_message\'\n\n        # Cleanup\n        publisher.destroy_node()\n        subscriber.destroy_node()\n'})}),"\n",(0,i.jsx)(n.h2,{id:"vla-pipeline-integration-tests",children:"VLA Pipeline Integration Tests"}),"\n",(0,i.jsx)(n.h3,{id:"test-whisper--llm--action-pipeline",children:"Test Whisper \u2192 LLM \u2192 Action Pipeline"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# test_vla_pipeline.py\nimport pytest\nfrom unittest.mock import Mock, patch\nimport asyncio\n\nclass TestVLAPipeline:\n    @pytest.mark.asyncio\n    async def test_voice_command_to_action(self):\n        \"\"\"Test complete VLA pipeline.\"\"\"\n\n        # Mock components\n        with patch('whisper.load_model') as mock_whisper, \\\n             patch('anthropic.Anthropic') as mock_claude:\n\n            # Setup mocks\n            mock_whisper.return_value.transcribe.return_value = {\n                'text': 'go to the kitchen'\n            }\n\n            mock_claude.return_value.messages.create.return_value = Mock(\n                content=[Mock(\n                    type='tool_use',\n                    name='create_robot_plan',\n                    input={\n                        'goal': 'Navigate to kitchen',\n                        'actions': [\n                            {'action': 'navigate', 'target': 'kitchen'}\n                        ]\n                    }\n                )]\n            )\n\n            # Run pipeline\n            from vla_pipeline import VLAPipeline\n            pipeline = VLAPipeline()\n\n            result = await pipeline.process_voice_command('audio.wav')\n\n            # Assertions\n            assert result['transcription'] == 'go to the kitchen'\n            assert len(result['actions']) == 1\n            assert result['actions'][0]['action'] == 'navigate'\n            assert result['actions'][0]['target'] == 'kitchen'\n\n    def test_error_handling_whisper_failure(self):\n        \"\"\"Test pipeline handles Whisper failure gracefully.\"\"\"\n\n        with patch('whisper.load_model') as mock_whisper:\n            mock_whisper.return_value.transcribe.side_effect = Exception(\"Whisper error\")\n\n            from vla_pipeline import VLAPipeline\n            pipeline = VLAPipeline()\n\n            with pytest.raises(Exception) as exc_info:\n                pipeline.process_voice_command('audio.wav')\n\n            assert \"Whisper error\" in str(exc_info.value)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"rag-chatbot-integration-tests",children:"RAG Chatbot Integration Tests"}),"\n",(0,i.jsx)(n.h3,{id:"test-document-retrieval-and-response-generation",children:"Test Document Retrieval and Response Generation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# test_rag_integration.py\nimport pytest\nfrom qdrant_client import QdrantClient\nfrom openai import OpenAI\nimport anthropic\n\nclass TestRAGIntegration:\n    @pytest.fixture\n    def rag_pipeline(self):\n        \"\"\"Create RAG pipeline for testing.\"\"\"\n        from rag_pipeline import RAGPipeline\n        return RAGPipeline(\n            qdrant_url=os.getenv('QDRANT_TEST_URL'),\n            openai_key=os.getenv('OPENAI_API_KEY'),\n            claude_key=os.getenv('ANTHROPIC_API_KEY')\n        )\n\n    def test_document_ingestion(self, rag_pipeline):\n        \"\"\"Test document ingestion into vector DB.\"\"\"\n\n        # Ingest test document\n        test_doc = {\n            'text': 'ROS 2 uses a publisher-subscriber pattern for communication.',\n            'metadata': {'module': '01', 'chapter': '02'}\n        }\n\n        doc_id = rag_pipeline.ingest_document(test_doc)\n\n        # Verify document was stored\n        assert doc_id is not None\n\n        # Query for document\n        results = rag_pipeline.search('publisher subscriber pattern')\n\n        assert len(results) > 0\n        assert 'publisher-subscriber' in results[0]['text']\n\n    def test_query_response_generation(self, rag_pipeline):\n        \"\"\"Test complete RAG query flow.\"\"\"\n\n        # Query chatbot\n        response = rag_pipeline.query('How do I create a ROS 2 publisher?')\n\n        # Assertions\n        assert response['answer'] is not None\n        assert len(response['answer']) > 0\n        assert len(response['sources']) > 0\n        assert 'create_publisher' in response['answer'].lower()\n\n    def test_context_relevance(self, rag_pipeline):\n        \"\"\"Test that retrieved context is relevant to query.\"\"\"\n\n        query = \"What is SLAM?\"\n        response = rag_pipeline.query(query)\n\n        # Check that sources are relevant\n        for source in response['sources']:\n            assert source['relevance_score'] > 0.5\n            assert any(keyword in source['text'].lower()\n                      for keyword in ['slam', 'localization', 'mapping'])\n"})}),"\n",(0,i.jsx)(n.h2,{id:"simulation-integration-tests",children:"Simulation Integration Tests"}),"\n",(0,i.jsx)(n.h3,{id:"test-gazebo--ros-2-integration",children:"Test Gazebo + ROS 2 Integration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# test_gazebo_integration.py\nimport pytest\nimport subprocess\nimport time\nimport rclpy\nfrom geometry_msgs.msg import Twist\n\nclass TestGazeboIntegration:\n    @classmethod\n    def setup_class(cls):\n        """Launch Gazebo simulation."""\n        cls.gazebo_process = subprocess.Popen(\n            [\'gz\', \'sim\', \'test_world.sdf\', \'-s\'],  # Headless\n            stdout=subprocess.PIPE,\n            stderr=subprocess.PIPE\n        )\n        time.sleep(5)  # Wait for Gazebo to start\n        rclpy.init()\n\n    @classmethod\n    def teardown_class(cls):\n        """Stop Gazebo simulation."""\n        cls.gazebo_process.terminate()\n        cls.gazebo_process.wait()\n        rclpy.shutdown()\n\n    def test_robot_spawning(self):\n        """Test that robot can be spawned in Gazebo."""\n\n        # Spawn robot\n        result = subprocess.run(\n            [\'ros2\', \'service\', \'call\', \'/spawn_entity\',\n             \'gazebo_msgs/srv/SpawnEntity\',\n             \'{name: "test_robot", xml: "$(cat test_robot.urdf)"}\'],\n            capture_output=True,\n            text=True\n        )\n\n        assert result.returncode == 0\n        assert \'success\' in result.stdout.lower()\n\n    def test_robot_movement(self):\n        """Test robot responds to velocity commands."""\n\n        # Create velocity publisher\n        node = rclpy.create_node(\'test_movement\')\n        pub = node.create_publisher(Twist, \'/cmd_vel\', 10)\n\n        # Publish velocity command\n        msg = Twist()\n        msg.linear.x = 0.5\n        pub.publish(msg)\n\n        time.sleep(1)\n\n        # TODO: Verify robot moved (check /odom or /joint_states)\n\n        node.destroy_node()\n'})}),"\n",(0,i.jsx)(n.h2,{id:"continuous-integration-tests",children:"Continuous Integration Tests"}),"\n",(0,i.jsx)(n.h3,{id:"github-actions-workflow",children:"GitHub Actions Workflow"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"# .github/workflows/integration-tests.yml\nname: Integration Tests\n\non:\n  push:\n    branches: [main, develop]\n  pull_request:\n\njobs:\n  test-ros2:\n    runs-on: ubuntu-22.04\n\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup ROS 2 Humble\n        uses: ros-tooling/setup-ros@v0.6\n        with:\n          required-ros-distributions: humble\n\n      - name: Install dependencies\n        run: |\n          sudo apt update\n          sudo apt install -y ros-humble-gazebo-ros-pkgs\n          pip3 install pytest pytest-asyncio\n\n      - name: Build workspace\n        run: |\n          source /opt/ros/humble/setup.bash\n          cd ros2_ws\n          colcon build\n\n      - name: Run integration tests\n        run: |\n          source /opt/ros/humble/setup.bash\n          source ros2_ws/install/setup.bash\n          pytest tests/integration/ -v\n\n  test-vla:\n    runs-on: ubuntu-22.04\n\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Python\n        uses: actions/setup-python@v4\n        with:\n          python-version: '3.10'\n\n      - name: Install dependencies\n        run: |\n          pip install -r chatbot/requirements.txt\n          pip install pytest pytest-asyncio pytest-mock\n\n      - name: Run VLA tests\n        env:\n          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}\n          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}\n        run: |\n          pytest tests/vla/ -v\n\n  test-rag:\n    runs-on: ubuntu-22.04\n\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Python\n        uses: actions/setup-python@v4\n        with:\n          python-version: '3.10'\n\n      - name: Install dependencies\n        run: |\n          pip install -r chatbot/requirements.txt\n          pip install pytest pytest-asyncio\n\n      - name: Run RAG tests\n        env:\n          QDRANT_URL: ${{ secrets.QDRANT_TEST_URL }}\n          QDRANT_API_KEY: ${{ secrets.QDRANT_API_KEY }}\n          DATABASE_URL: ${{ secrets.DATABASE_TEST_URL }}\n          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}\n          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}\n        run: |\n          pytest tests/rag/ -v\n"})}),"\n",(0,i.jsx)(n.h2,{id:"load-testing",children:"Load Testing"}),"\n",(0,i.jsx)(n.h3,{id:"test-api-performance",children:"Test API Performance"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# test_load.py\nimport asyncio\nimport aiohttp\nimport time\nfrom statistics import mean, median\n\nasync def load_test_chatbot(num_requests=100):\n    """Load test the chatbot API."""\n\n    async def send_query(session, query):\n        start = time.time()\n        async with session.post(\n            \'http://localhost:8000/chat\',\n            json={\'query\': query}\n        ) as response:\n            await response.json()\n            return time.time() - start\n\n    queries = [\n        "How do I create a ROS 2 publisher?",\n        "What is SLAM?",\n        "Explain Nav2 navigation",\n    ] * (num_requests // 3)\n\n    async with aiohttp.ClientSession() as session:\n        tasks = [send_query(session, q) for q in queries]\n        response_times = await asyncio.gather(*tasks)\n\n    # Print statistics\n    print(f"Total requests: {num_requests}")\n    print(f"Mean response time: {mean(response_times):.2f}s")\n    print(f"Median response time: {median(response_times):.2f}s")\n    print(f"Min response time: {min(response_times):.2f}s")\n    print(f"Max response time: {max(response_times):.2f}s")\n\n# Run load test\nasyncio.run(load_test_chatbot(100))\n'})}),"\n",(0,i.jsx)(n.h2,{id:"test-coverage",children:"Test Coverage"}),"\n",(0,i.jsx)(n.h3,{id:"generate-coverage-report",children:"Generate Coverage Report"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Run tests with coverage\npytest --cov=app --cov-report=html tests/\n\n# View coverage report\nopen htmlcov/index.html\n\n# Target: 80%+ coverage\n"})}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Isolate Tests"}),": Each test should be independent"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use Fixtures"}),": Reuse common setup code"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Mock External APIs"}),": Don't call real APIs in tests"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Test Edge Cases"}),": Not just happy paths"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Fast Tests"}),": Keep test suite under 5 minutes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Meaningful Assertions"}),": Test behavior, not implementation"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Intermediate/Testing/Testing-Main.html",children:"ROS 2 Testing Guide"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.pytest.org/",children:"pytest Documentation"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://fastapi.tiangolo.com/tutorial/testing/",children:"FastAPI Testing"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var s=t(6540);const i={},r=s.createContext(i);function o(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);