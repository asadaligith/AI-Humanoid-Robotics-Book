"use strict";(self.webpackChunkai_humanoid_robotics_book=self.webpackChunkai_humanoid_robotics_book||[]).push([[101],{7688:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"modules/module-05-capstone/troubleshooting","title":"Troubleshooting Guide","description":"Overview","source":"@site/docs/modules/module-05-capstone/troubleshooting.md","sourceDirName":"modules/module-05-capstone","slug":"/modules/module-05-capstone/troubleshooting","permalink":"/AI-Humanoid-Robotics-Book/docs/modules/module-05-capstone/troubleshooting","draft":false,"unlisted":false,"editUrl":"https://github.com/asadaligith/AI-Humanoid-Robotics-Book/tree/main/docs/modules/module-05-capstone/troubleshooting.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9},"sidebar":"tutorialSidebar","previous":{"title":"Performance Benchmarking","permalink":"/AI-Humanoid-Robotics-Book/docs/modules/module-05-capstone/benchmarking"}}');var r=s(4848),o=s(8453);const t={sidebar_position:9},a="Troubleshooting Guide",c={},l=[{value:"Overview",id:"overview",level:2},{value:"General Debugging Strategy",id:"general-debugging-strategy",level:2},{value:"Systematic Debugging Workflow",id:"systematic-debugging-workflow",level:2},{value:"1. Voice Not Detected",id:"1-voice-not-detected",level:2},{value:"Symptoms",id:"symptoms",level:3},{value:"Root Causes",id:"root-causes",level:3},{value:"Verification",id:"verification",level:3},{value:"2. LLM Timeout or Invalid Output",id:"2-llm-timeout-or-invalid-output",level:2},{value:"Symptoms",id:"symptoms-1",level:3},{value:"Root Causes",id:"root-causes-1",level:3},{value:"Verification",id:"verification-1",level:3},{value:"3. Navigation Failures",id:"3-navigation-failures",level:2},{value:"Symptoms",id:"symptoms-2",level:3},{value:"Root Causes",id:"root-causes-2",level:3},{value:"Verification",id:"verification-2",level:3},{value:"4. Object Not Detected",id:"4-object-not-detected",level:2},{value:"Symptoms",id:"symptoms-3",level:3},{value:"Root Causes",id:"root-causes-3",level:3},{value:"Verification",id:"verification-3",level:3},{value:"5. Grasp Failures",id:"5-grasp-failures",level:2},{value:"Symptoms",id:"symptoms-4",level:3},{value:"Root Causes",id:"root-causes-4",level:3},{value:"Verification",id:"verification-4",level:3},{value:"Edge Case Handling",id:"edge-case-handling",level:2},{value:"Ambiguous Voice Commands",id:"ambiguous-voice-commands",level:3},{value:"No Valid Navigation Path",id:"no-valid-navigation-path",level:3},{value:"Wrong Object Grasped",id:"wrong-object-grasped",level:3},{value:"LLM API Down",id:"llm-api-down",level:3},{value:"Diagnostic Tools",id:"diagnostic-tools",level:2},{value:"ROS 2 Introspection",id:"ros-2-introspection",level:3},{value:"Gazebo Debugging",id:"gazebo-debugging",level:3},{value:"Log Analysis",id:"log-analysis",level:3},{value:"Summary",id:"summary",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"troubleshooting-guide",children:"Troubleshooting Guide"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"This guide addresses common integration issues and edge cases encountered when deploying the autonomous humanoid capstone system. Each section provides symptom descriptions, root cause analysis, and step-by-step resolution procedures."}),"\n",(0,r.jsx)(n.h2,{id:"general-debugging-strategy",children:"General Debugging Strategy"}),"\n",(0,r.jsx)(n.p,{children:"Before diving into specific issues:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Check System Status"}),": ",(0,r.jsx)(n.code,{children:"ros2 topic echo /system/status"})," (current FSM state)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Verify Node Health"}),": ",(0,r.jsx)(n.code,{children:"ros2 node list"})," (all expected nodes running?)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Inspect Logs"}),": ",(0,r.jsx)(n.code,{children:"ros2 run rqt_console rqt_console"})," (error messages)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Monitor Topics"}),": ",(0,r.jsx)(n.code,{children:"ros2 topic hz <topic>"})," (message publication rates)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Validate Transforms"}),": ",(0,r.jsx)(n.code,{children:"ros2 run tf2_tools view_frames"})," (coordinate frame tree)"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"systematic-debugging-workflow",children:"Systematic Debugging Workflow"}),"\n",(0,r.jsx)(n.p,{children:"When diagnosing complex integration failures, follow this structured methodology to isolate root causes efficiently:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Phase 1: Identify Symptom Location"})," (5 minutes). Monitor the ",(0,r.jsx)(n.code,{children:"/system/status"})," topic to determine which FSM state the system is stuck in\u2014IDLE, LISTENING, PLANNING, NAVIGATING, PERCEIVING, or MANIPULATING. This immediately narrows the failure domain to one of five capabilities. For example, if stuck in PLANNING state for >10 seconds, the issue resides in the LLM planner node, not navigation or perception."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Phase 2: Verify Input Dependencies"})," (10 minutes). Before debugging the failing component, validate that its inputs are correct. If navigation fails, first confirm the LLM published a valid action sequence (",(0,r.jsx)(n.code,{children:"ros2 topic echo /llm/action_sequence"}),') and the goal pose is within map bounds. Many "navigation failures" are actually upstream planning failures that produce invalid goals. Checking inputs first prevents debugging the wrong component.']}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Phase 3: Enable Mock Modes for Isolation"})," (5 minutes). Set the failing component's mock flag to ",(0,r.jsx)(n.code,{children:"True"})," while keeping others real. If the system proceeds past the failure point with the mock enabled, the issue is confirmed within that specific capability's implementation\u2014not integration logic. This binary search approach (mock vs real) eliminates 80% of possible failure locations within minutes, compared to hours of manual code inspection."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Phase 4: Analyze Logs with Timestamps"})," (10 minutes). Use ",(0,r.jsx)(n.code,{children:"rqt_console"}),' to view error messages, but critically, check timestamps to verify message ordering. A "grasp failed" error at T+30s followed by "object not found" at T+25s indicates the detection failure caused the grasp attempt on a null object. Temporal analysis reveals causality chains that symptom-based debugging misses.']}),"\n",(0,r.jsx)(n.h2,{id:"1-voice-not-detected",children:"1. Voice Not Detected"}),"\n",(0,r.jsx)(n.h3,{id:"symptoms",children:"Symptoms"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Voice input node running but no transcriptions published to ",(0,r.jsx)(n.code,{children:"/voice/transcribed_text"})]}),"\n",(0,r.jsx)(n.li,{children:'Console shows "No voice activity detected" repeatedly'}),"\n",(0,r.jsxs)(n.li,{children:["System stuck in ",(0,r.jsx)(n.code,{children:"IDLE"})," or ",(0,r.jsx)(n.code,{children:"LISTENING"})," state"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"root-causes",children:"Root Causes"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A. Microphone Not Accessible"})}),"\n",(0,r.jsx)(n.p,{children:"Check microphone permissions and device availability:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# List audio devices\r\narecord -l\r\n\r\n# Test microphone recording\r\narecord -d 3 -f cd test.wav\r\naplay test.wav  # Should hear playback\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Verify Docker container has ",(0,r.jsx)(n.code,{children:"--device=/dev/snd:/dev/snd"})," flag"]}),"\n",(0,r.jsxs)(n.li,{children:["Check PulseAudio permissions: ",(0,r.jsx)(n.code,{children:"usermod -aG audio $USER"})]}),"\n",(0,r.jsx)(n.li,{children:"Use USB headset microphone as alternative"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"B. Silence Threshold Too High"})}),"\n",(0,r.jsx)(n.p,{children:"Voice activity detection may be too conservative."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# config/voice_config.yaml\r\nsilence_threshold: 0.01  # Lower to 0.005 for quieter environments\r\nduration: 3.0  # Increase to 4.0 for longer commands\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"C. Wrong Audio Input Device"})}),"\n",(0,r.jsx)(n.p,{children:"Multiple microphones may confuse device selection."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# voice_input_node.py\r\n# Explicitly set device index\r\nimport sounddevice as sd\r\nprint(sd.query_devices())  # List all devices\r\nsd.default.device = 1  # Set to correct input device index\n"})}),"\n",(0,r.jsx)(n.h3,{id:"verification",children:"Verification"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Monitor transcriptions\r\nros2 topic echo /voice/transcribed_text\r\n\r\n# Expected output after speaking "bring me the mug":\r\ndata: "Bring me the mug"\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"2-llm-timeout-or-invalid-output",children:"2. LLM Timeout or Invalid Output"}),"\n",(0,r.jsx)(n.h3,{id:"symptoms-1",children:"Symptoms"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["System stuck in ",(0,r.jsx)(n.code,{children:"PLANNING"})," state for >30 seconds"]}),"\n",(0,r.jsx)(n.li,{children:'Error: "Failed to parse plan JSON"'}),"\n",(0,r.jsx)(n.li,{children:"LLM returns hallucinated actions not in capability manifest"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"root-causes-1",children:"Root Causes"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A. API Key Not Configured"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check if OpenAI API key is set\r\necho $OPENAI_API_KEY\r\n\r\n# Expected: sk-proj-...\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'export OPENAI_API_KEY="sk-proj-YOUR_KEY_HERE"\r\n# Or add to ~/.bashrc for persistence\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"B. Network Connectivity Issues"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Test API connectivity\r\ncurl https://api.openai.com/v1/models \\\r\n  -H "Authorization: Bearer $OPENAI_API_KEY"\r\n\r\n# Should return JSON with model list\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check firewall rules (allow HTTPS to api.openai.com)"}),"\n",(0,r.jsx)(n.li,{children:"Verify internet connection"}),"\n",(0,r.jsx)(n.li,{children:"Use local LLM as fallback (Llama 2 via Ollama)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"C. LLM Output Schema Mismatch"})}),"\n",(0,r.jsx)(n.p,{children:"LLM may not follow expected JSON format."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# llm_planner_node.py - add strict schema validation\r\nimport jsonschema\r\n\r\nschema = {\r\n    "type": "object",\r\n    "properties": {\r\n        "action_sequence": {"type": "array"},\r\n        "confidence": {"type": "number"}\r\n    },\r\n    "required": ["action_sequence", "confidence"]\r\n}\r\n\r\ntry:\r\n    jsonschema.validate(instance=llm_output, schema=schema)\r\nexcept jsonschema.ValidationError as e:\r\n    self.get_logger().error(f"Invalid LLM output: {e.message}")\r\n    # Request clarification or use fallback plan\n'})}),"\n",(0,r.jsx)(n.h3,{id:"verification-1",children:"Verification"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Publish test command\r\nros2 topic pub /voice/transcribed_text std_msgs/String \\\r\n  \"{data: 'Bring me the mug'}\"\r\n\r\n# Monitor LLM output\r\nros2 topic echo /llm/action_sequence\r\n\r\n# Expected: JSON with action_sequence array\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"3-navigation-failures",children:"3. Navigation Failures"}),"\n",(0,r.jsx)(n.h3,{id:"symptoms-2",children:"Symptoms"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'Nav2 goal aborted with "No valid path found"'}),"\n",(0,r.jsx)(n.li,{children:"Robot gets stuck oscillating in place"}),"\n",(0,r.jsx)(n.li,{children:"Collision detected in planning scene"}),"\n",(0,r.jsx)(n.li,{children:"Navigation timeout after 30 seconds"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"root-causes-2",children:"Root Causes"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A. Costmap Inflation Too Conservative"})}),"\n",(0,r.jsx)(n.p,{children:"Obstacles appear larger than reality, blocking narrow passages."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# config/nav2_params.yaml\r\nlocal_costmap:\r\n  local_costmap:\r\n    ros__parameters:\r\n      inflation_layer:\r\n        inflation_radius: 0.35  # Reduce from 0.55m to 0.35m\r\n        cost_scaling_factor: 2.0  # Reduce from 3.0\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"B. Map-Odometry Mismatch"})}),"\n",(0,r.jsx)(n.p,{children:"SLAM localization may have drifted."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check TF tree for map\u2192odom transform\r\nros2 run tf2_tools view_frames\r\n\r\n# Re-localize robot (publish initial pose estimate)\r\nros2 topic pub /initialpose geometry_msgs/PoseWithCovarianceStamped \\\r\n  \"{header: {frame_id: 'map'}, pose: {pose: {position: {x: 0, y: 0}}}}\"\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"C. Goal Pose Unreachable"})}),"\n",(0,r.jsx)(n.p,{children:"Target location may be inside obstacle or outside map bounds."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Validate goal before sending to Nav2\r\ndef validate_goal(pose: PoseStamped) -> bool:\r\n    # Check if within map bounds\r\n    if not (MAP_MIN_X <= pose.pose.position.x <= MAP_MAX_X):\r\n        return False\r\n\r\n    # Check if goal is in free space (query costmap)\r\n    costmap_value = query_costmap(pose.pose.position.x, pose.pose.position.y)\r\n    return costmap_value < LETHAL_OBSTACLE_THRESHOLD\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"D. Recovery Behaviors Not Configured"})}),"\n",(0,r.jsx)(n.p,{children:"Robot gives up immediately without attempting recovery."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# config/nav2_params.yaml\r\nbehavior_server:\r\n  ros__parameters:\r\n    costmap_topic: local_costmap/costmap_raw\r\n    behavior_plugins: ["spin", "backup", "wait"]\r\n    spin:\r\n      plugin: "nav2_behaviors::Spin"\r\n      max_retries: 3  # Retry spin recovery 3 times\n'})}),"\n",(0,r.jsx)(n.h3,{id:"verification-2",children:"Verification"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Send test navigation goal\r\nros2 topic pub /navigation/goal geometry_msgs/PoseStamped \\\r\n  "{header: {frame_id: \'map\'}, pose: {position: {x: 2.0, y: 1.0}}}"\r\n\r\n# Monitor navigation status\r\nros2 topic echo /navigation/status\r\n\r\n# Expected: "SUCCEEDED" within 15 seconds\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"4-object-not-detected",children:"4. Object Not Detected"}),"\n",(0,r.jsx)(n.h3,{id:"symptoms-3",children:"Symptoms"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Perception node running but no detections published"}),"\n",(0,r.jsxs)(n.li,{children:["System stuck in ",(0,r.jsx)(n.code,{children:"PERCEIVING"})," state"]}),"\n",(0,r.jsx)(n.li,{children:"Detection confidence too low (<0.6 threshold)"}),"\n",(0,r.jsx)(n.li,{children:"Wrong object detected (cup instead of mug)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"root-causes-3",children:"Root Causes"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A. Camera Not Publishing Images"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check camera topic\r\nros2 topic hz /camera/image_raw\r\n\r\n# Expected: 10-30 Hz\r\n# If 0 Hz, camera node is down or device not connected\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Verify camera device: ",(0,r.jsx)(n.code,{children:"v4l2-ctl --list-devices"})]}),"\n",(0,r.jsxs)(n.li,{children:["Restart camera node: ",(0,r.jsx)(n.code,{children:"ros2 run capstone_demo camera_node"})]}),"\n",(0,r.jsx)(n.li,{children:"Check Gazebo simulation camera plugin is active"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"B. Object Not in YOLO Training Set"})}),"\n",(0,r.jsx)(n.p,{children:"COCO dataset may not include target object."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# config/detection_classes.yaml\r\n# Map LLM object names to closest COCO class\r\nllm_to_coco_mapping:\r\n  "coffee mug": "cup"  # YOLO trained on "cup", not "mug"\r\n  "water bottle": "bottle"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"C. Confidence Threshold Too High"})}),"\n",(0,r.jsx)(n.p,{children:"Detection exists but confidence <0.6 (rejected)."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# object_detection_node.py\r\nself.conf_threshold = 0.5  # Reduce from 0.6 to 0.5\r\n\r\n# Or use class-specific thresholds\r\nclass_thresholds = {\r\n    'mug': 0.7,  # Higher for common objects\r\n    'apple': 0.5  # Lower for small objects\r\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"D. Lighting Conditions Poor"})}),"\n",(0,r.jsx)(n.p,{children:"Camera image too dark or overexposed."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Adaptive histogram equalization\r\nimport cv2\r\nframe_gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)\r\nframe_equalized = cv2.equalizeHist(frame_gray)\r\nframe = cv2.cvtColor(frame_equalized, cv2.COLOR_GRAY2BGR)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"verification-3",children:"Verification"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Visualize detections\r\nros2 run rqt_image_view rqt_image_view /perception/annotated_image\r\n\r\n# Should show bounding boxes around detected objects\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"5-grasp-failures",children:"5. Grasp Failures"}),"\n",(0,r.jsx)(n.h3,{id:"symptoms-4",children:"Symptoms"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Gripper closes but object not grasped (falls immediately)"}),"\n",(0,r.jsx)(n.li,{children:'MoveIt planning fails with "IK solution not found"'}),"\n",(0,r.jsx)(n.li,{children:"Manipulation timeout after 20 seconds"}),"\n",(0,r.jsx)(n.li,{children:"Collision detected during grasp approach"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"root-causes-4",children:"Root Causes"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"A. Object Pose Inaccurate"})}),"\n",(0,r.jsx)(n.p,{children:"2D detection doesn't provide accurate 3D position."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Use depth camera to estimate 3D pose\r\nfrom sensor_msgs.msg import PointCloud2\r\n\r\ndef estimate_3d_pose(detection_2d, depth_image):\r\n    # Project 2D bbox center to 3D using depth\r\n    center_x, center_y = detection_2d.bbox.center.x, detection_2d.bbox.center.y\r\n    depth_value = depth_image[int(center_y), int(center_x)]\r\n\r\n    # Convert to 3D point in camera frame\r\n    point_3d = project_to_3d(center_x, center_y, depth_value)\r\n\r\n    return point_3d\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"B. Pre-Grasp Offset Insufficient"})}),"\n",(0,r.jsx)(n.p,{children:"Gripper collides with table during approach."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# config/grasp_poses.yaml\r\nmug:\r\n  pre_grasp_offset: 0.15  # Increase from 0.10m to 0.15m\r\n  approach_vector: [0, 0, -1]  # Ensure vertical approach\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"C. Gripper Force Too Weak"})}),"\n",(0,r.jsx)(n.p,{children:"Object slips due to insufficient grip force."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# manipulation_controller.py\r\ndef close_gripper(self, force=150):  # Increase from default 100N\r\n    gripper_msg = JointState()\r\n    gripper_msg.name = ['gripper_joint']\r\n    gripper_msg.effort = [force]  # Higher force\r\n    self.gripper_pub.publish(gripper_msg)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"D. IK Solver Failure"})}),"\n",(0,r.jsx)(n.p,{children:"Target pose outside robot's reachable workspace."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Validate pose before IK query\r\ndef is_reachable(target_pose: Pose) -> bool:\r\n    distance = sqrt(target_pose.position.x**2 + target_pose.position.y**2)\r\n    return MIN_REACH <= distance <= MAX_REACH  # e.g., 0.2m to 0.8m\r\n\r\nif not is_reachable(grasp_pose):\r\n    self.get_logger().error("Object outside reachable workspace")\r\n    # Move robot base closer before grasping\r\n    self.navigate_to_pre_grasp_location(grasp_pose)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"verification-4",children:"Verification"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Send test pick command\r\nros2 topic pub /manipulation/pick_target geometry_msgs/PoseStamped \\\r\n  "{header: {frame_id: \'base_link\'}, pose: {position: {x: 0.5, y: 0.0, z: 0.8}}}"\r\n\r\n# Monitor manipulation status\r\nros2 topic echo /manipulation/status\r\n\r\n# Expected: "PICK_SUCCESS" within 10 seconds\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"edge-case-handling",children:"Edge Case Handling"}),"\n",(0,r.jsx)(n.h3,{id:"ambiguous-voice-commands",children:"Ambiguous Voice Commands"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Scenario"}),': "Get the object from the table" (which object?)']}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# llm_planner_node.py - detect ambiguity in plan\r\nif plan['confidence'] < 0.7:\r\n    clarification = \"Which object would you like? Please specify color or type.\"\r\n    self.clarification_pub.publish(String(data=clarification))\r\n    self.state = State.AWAITING_CLARIFICATION\n"})}),"\n",(0,r.jsx)(n.h3,{id:"no-valid-navigation-path",children:"No Valid Navigation Path"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Scenario"}),": Kitchen blocked by obstacles, no path exists"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# integration_demo.py - retry with replanning\r\nif nav_status == "ABORTED" and self.retry_count < 3:\r\n    self.retry_count += 1\r\n    # Clear costmap and try alternative route\r\n    self.clear_costmap_service.call_async(Empty.Request())\r\n    time.sleep(1.0)\r\n    self.execute_navigation(params)  # Retry\r\nelse:\r\n    # Request LLM to replan with different location\r\n    self.request_llm_replan("Navigation to kitchen failed. Try alternative route.")\n'})}),"\n",(0,r.jsx)(n.h3,{id:"wrong-object-grasped",children:"Wrong Object Grasped"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Scenario"}),": Grasped cup instead of mug (visually similar)"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Validate object after grasp using gripper force sensor\r\nexpected_object = "mug"\r\nexpected_weight = 0.3  # kg (from object database)\r\n\r\nactual_weight = self.get_gripper_force() / 9.81  # Convert force to mass\r\n\r\nif abs(actual_weight - expected_weight) > 0.1:\r\n    self.get_logger().warn(f"Grasped wrong object (expected {expected_weight}kg, got {actual_weight}kg)")\r\n    # Drop object and retry with stricter detection\r\n    self.open_gripper()\r\n    self.execute_detection(params, conf_threshold=0.8)  # Increase threshold\n'})}),"\n",(0,r.jsx)(n.h3,{id:"llm-api-down",children:"LLM API Down"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Scenario"}),": OpenAI API returns 503 Service Unavailable"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resolution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Use cached plans for common commands\r\nCACHED_PLANS = {\r\n    "bring me the mug from the kitchen": [\r\n        {"action": "navigate_to", "params": {"location": "kitchen"}},\r\n        {"action": "detect_object", "params": {"name": "mug"}},\r\n        {"action": "pick_object", "params": {"object_id": "mug_0"}},\r\n        {"action": "navigate_to", "params": {"location": "user"}},\r\n        {"action": "place_object", "params": {"location": "table"}}\r\n    ]\r\n}\r\n\r\ntry:\r\n    plan = self.query_llm(voice_command)\r\nexcept requests.exceptions.RequestException:\r\n    # Fallback to cached plan\r\n    plan = CACHED_PLANS.get(voice_command.lower())\r\n    if plan:\r\n        self.get_logger().warn("LLM API down, using cached plan")\r\n    else:\r\n        self.transition_to(State.FAILED)\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"diagnostic-tools",children:"Diagnostic Tools"}),"\n",(0,r.jsx)(n.h3,{id:"ros-2-introspection",children:"ROS 2 Introspection"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# List all active nodes\r\nros2 node list\r\n\r\n# Check node info\r\nros2 node info /integration_demo\r\n\r\n# Monitor topic publication rate\r\nros2 topic hz /system/status\r\n\r\n# Echo topic for debugging\r\nros2 topic echo /voice/transcribed_text\r\n\r\n# Visualize TF tree\r\nros2 run tf2_tools view_frames\r\nevince frames.pdf\n"})}),"\n",(0,r.jsx)(n.h3,{id:"gazebo-debugging",children:"Gazebo Debugging"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Enable Gazebo verbose logging\r\ngazebo --verbose\r\n\r\n# Inspect model poses\r\ngz model -m unitree_g1 -p\r\n\r\n# Check sensor outputs\r\ngz topic -e /camera/image_raw\n"})}),"\n",(0,r.jsx)(n.h3,{id:"log-analysis",children:"Log Analysis"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# View all logs\r\nros2 run rqt_console rqt_console\r\n\r\n# Filter by severity\r\nros2 run rqt_console rqt_console --filter-severity error\r\n\r\n# Export logs to file\r\nros2 run rqt_console rqt_console > capstone_logs.txt\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"Effective troubleshooting requires systematic diagnosis:"}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Monitor system status"})," continuously (",(0,r.jsx)(n.code,{children:"/system/status"})," topic) to identify which capability failed"]}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Verify component isolation"})," - test each capability independently using methods from ",(0,r.jsx)(n.a,{href:"/AI-Humanoid-Robotics-Book/docs/modules/module-05-capstone/testing-methodology",children:"Testing Methodology"})]}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Inspect logs and metrics"})," - ROS 2 console, Gazebo verbose output, resource monitoring"]}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Implement graceful degradation"})," - retry logic, fallback plans, clarification requests"]}),"\n",(0,r.jsx)(n.p,{children:"Most integration failures trace to configuration mismatches (wrong thresholds, missing API keys, incorrect transforms) rather than algorithmic bugs. Systematic validation of each component's inputs and outputs accelerates root cause identification."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Next Steps"}),": Return to ",(0,r.jsx)(n.a,{href:"/AI-Humanoid-Robotics-Book/docs/modules/module-05-capstone/chapter-01-architecture",children:"System Architecture"})," for component interaction overview, or proceed to ",(0,r.jsx)(n.a,{href:"/AI-Humanoid-Robotics-Book/docs/modules/module-05-capstone/benchmarking",children:"Benchmarking"})," to quantify system performance after resolving issues."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>a});var i=s(6540);const r={},o=i.createContext(r);function t(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);