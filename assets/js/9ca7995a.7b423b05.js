"use strict";(self.webpackChunkai_humanoid_robotics_book=self.webpackChunkai_humanoid_robotics_book||[]).push([[2987],{415:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"testing/integration-testing","title":"Integration Testing Guide","description":"Overview","source":"@site/docs/testing/integration-testing.md","sourceDirName":"testing","slug":"/testing/integration-testing","permalink":"/docs/testing/integration-testing","draft":false,"unlisted":false,"editUrl":"https://github.com/asadaligith/AI-Humanoid-Robotics-Book/tree/main/docs/testing/integration-testing.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"API Integration Reference","permalink":"/docs/integrations/api-reference"},"next":{"title":"Student Success Guide","permalink":"/docs/community/student-guide"}}');var s=r(4848),i=r(8453);const o={},a="Integration Testing Guide",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Testing Levels",id:"testing-levels",level:2},{value:"ROS 2 Integration Testing",id:"ros-2-integration-testing",level:2},{value:"Test Framework Setup",id:"test-framework-setup",level:3},{value:"Example: Testing Publisher-Subscriber",id:"example-testing-publisher-subscriber",level:3},{value:"VLA Pipeline Integration Tests",id:"vla-pipeline-integration-tests",level:2},{value:"Test Whisper \u2192 LLM \u2192 Action Pipeline",id:"test-whisper--llm--action-pipeline",level:3},{value:"RAG Chatbot Integration Tests",id:"rag-chatbot-integration-tests",level:2},{value:"Test Document Retrieval and Response Generation",id:"test-document-retrieval-and-response-generation",level:3},{value:"Simulation Integration Tests",id:"simulation-integration-tests",level:2},{value:"Test Gazebo + ROS 2 Integration",id:"test-gazebo--ros-2-integration",level:3},{value:"Continuous Integration Tests",id:"continuous-integration-tests",level:2},{value:"GitHub Actions Workflow",id:"github-actions-workflow",level:3},{value:"Load Testing",id:"load-testing",level:2},{value:"Test API Performance",id:"test-api-performance",level:3},{value:"Test Coverage",id:"test-coverage",level:2},{value:"Generate Coverage Report",id:"generate-coverage-report",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"References",id:"references",level:2}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"integration-testing-guide",children:"Integration Testing Guide"})}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"Integration testing ensures that all course components work together correctly: ROS 2 nodes, simulation environments, VLA pipeline, and the RAG chatbot."}),"\n",(0,s.jsx)(n.h2,{id:"testing-levels",children:"Testing Levels"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Unit Tests \u2192 Integration Tests \u2192 System Tests \u2192 E2E Tests\r\n   \u2193              \u2193                   \u2193            \u2193\r\n Functions    Components         Full Stack    User Flows\n"})}),"\n",(0,s.jsx)(n.h2,{id:"ros-2-integration-testing",children:"ROS 2 Integration Testing"}),"\n",(0,s.jsx)(n.h3,{id:"test-framework-setup",children:"Test Framework Setup"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Install testing dependencies\r\nsudo apt install -y \\\r\n  ros-humble-launch-testing \\\r\n  ros-humble-launch-testing-ament-cmake \\\r\n  ros-humble-launch-testing-ros\r\n\r\npip3 install pytest pytest-timeout pytest-asyncio\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-testing-publisher-subscriber",children:"Example: Testing Publisher-Subscriber"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# test_pubsub_integration.py\r\nimport pytest\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\nimport threading\r\nimport time\r\n\r\nclass TestPubSubIntegration:\r\n    @classmethod\r\n    def setup_class(cls):\r\n        """Initialize ROS 2."""\r\n        rclpy.init()\r\n\r\n    @classmethod\r\n    def teardown_class(cls):\r\n        """Shutdown ROS 2."""\r\n        rclpy.shutdown()\r\n\r\n    def test_publisher_subscriber_communication(self):\r\n        """Test that publisher and subscriber can communicate."""\r\n\r\n        # Create test nodes\r\n        class TestPublisher(Node):\r\n            def __init__(self):\r\n                super().__init__(\'test_publisher\')\r\n                self.publisher = self.create_publisher(String, \'test_topic\', 10)\r\n                self.timer = self.create_timer(0.5, self.publish_message)\r\n\r\n            def publish_message(self):\r\n                msg = String()\r\n                msg.data = \'test_message\'\r\n                self.publisher.publish(msg)\r\n\r\n        class TestSubscriber(Node):\r\n            def __init__(self):\r\n                super().__init__(\'test_subscriber\')\r\n                self.subscription = self.create_subscription(\r\n                    String, \'test_topic\', self.callback, 10)\r\n                self.received_messages = []\r\n\r\n            def callback(self, msg):\r\n                self.received_messages.append(msg.data)\r\n\r\n        # Create nodes\r\n        publisher = TestPublisher()\r\n        subscriber = TestSubscriber()\r\n\r\n        # Spin in separate thread\r\n        executor = rclpy.executors.MultiThreadedExecutor()\r\n        executor.add_node(publisher)\r\n        executor.add_node(subscriber)\r\n\r\n        thread = threading.Thread(target=executor.spin, daemon=True)\r\n        thread.start()\r\n\r\n        # Wait for messages\r\n        time.sleep(2)\r\n\r\n        # Assert messages were received\r\n        assert len(subscriber.received_messages) > 0\r\n        assert subscriber.received_messages[0] == \'test_message\'\r\n\r\n        # Cleanup\r\n        publisher.destroy_node()\r\n        subscriber.destroy_node()\n'})}),"\n",(0,s.jsx)(n.h2,{id:"vla-pipeline-integration-tests",children:"VLA Pipeline Integration Tests"}),"\n",(0,s.jsx)(n.h3,{id:"test-whisper--llm--action-pipeline",children:"Test Whisper \u2192 LLM \u2192 Action Pipeline"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# test_vla_pipeline.py\r\nimport pytest\r\nfrom unittest.mock import Mock, patch\r\nimport asyncio\r\n\r\nclass TestVLAPipeline:\r\n    @pytest.mark.asyncio\r\n    async def test_voice_command_to_action(self):\r\n        \"\"\"Test complete VLA pipeline.\"\"\"\r\n\r\n        # Mock components\r\n        with patch('whisper.load_model') as mock_whisper, \\\r\n             patch('anthropic.Anthropic') as mock_claude:\r\n\r\n            # Setup mocks\r\n            mock_whisper.return_value.transcribe.return_value = {\r\n                'text': 'go to the kitchen'\r\n            }\r\n\r\n            mock_claude.return_value.messages.create.return_value = Mock(\r\n                content=[Mock(\r\n                    type='tool_use',\r\n                    name='create_robot_plan',\r\n                    input={\r\n                        'goal': 'Navigate to kitchen',\r\n                        'actions': [\r\n                            {'action': 'navigate', 'target': 'kitchen'}\r\n                        ]\r\n                    }\r\n                )]\r\n            )\r\n\r\n            # Run pipeline\r\n            from vla_pipeline import VLAPipeline\r\n            pipeline = VLAPipeline()\r\n\r\n            result = await pipeline.process_voice_command('audio.wav')\r\n\r\n            # Assertions\r\n            assert result['transcription'] == 'go to the kitchen'\r\n            assert len(result['actions']) == 1\r\n            assert result['actions'][0]['action'] == 'navigate'\r\n            assert result['actions'][0]['target'] == 'kitchen'\r\n\r\n    def test_error_handling_whisper_failure(self):\r\n        \"\"\"Test pipeline handles Whisper failure gracefully.\"\"\"\r\n\r\n        with patch('whisper.load_model') as mock_whisper:\r\n            mock_whisper.return_value.transcribe.side_effect = Exception(\"Whisper error\")\r\n\r\n            from vla_pipeline import VLAPipeline\r\n            pipeline = VLAPipeline()\r\n\r\n            with pytest.raises(Exception) as exc_info:\r\n                pipeline.process_voice_command('audio.wav')\r\n\r\n            assert \"Whisper error\" in str(exc_info.value)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"rag-chatbot-integration-tests",children:"RAG Chatbot Integration Tests"}),"\n",(0,s.jsx)(n.h3,{id:"test-document-retrieval-and-response-generation",children:"Test Document Retrieval and Response Generation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# test_rag_integration.py\r\nimport pytest\r\nfrom qdrant_client import QdrantClient\r\nfrom openai import OpenAI\r\nimport anthropic\r\n\r\nclass TestRAGIntegration:\r\n    @pytest.fixture\r\n    def rag_pipeline(self):\r\n        \"\"\"Create RAG pipeline for testing.\"\"\"\r\n        from rag_pipeline import RAGPipeline\r\n        return RAGPipeline(\r\n            qdrant_url=os.getenv('QDRANT_TEST_URL'),\r\n            openai_key=os.getenv('OPENAI_API_KEY'),\r\n            claude_key=os.getenv('ANTHROPIC_API_KEY')\r\n        )\r\n\r\n    def test_document_ingestion(self, rag_pipeline):\r\n        \"\"\"Test document ingestion into vector DB.\"\"\"\r\n\r\n        # Ingest test document\r\n        test_doc = {\r\n            'text': 'ROS 2 uses a publisher-subscriber pattern for communication.',\r\n            'metadata': {'module': '01', 'chapter': '02'}\r\n        }\r\n\r\n        doc_id = rag_pipeline.ingest_document(test_doc)\r\n\r\n        # Verify document was stored\r\n        assert doc_id is not None\r\n\r\n        # Query for document\r\n        results = rag_pipeline.search('publisher subscriber pattern')\r\n\r\n        assert len(results) > 0\r\n        assert 'publisher-subscriber' in results[0]['text']\r\n\r\n    def test_query_response_generation(self, rag_pipeline):\r\n        \"\"\"Test complete RAG query flow.\"\"\"\r\n\r\n        # Query chatbot\r\n        response = rag_pipeline.query('How do I create a ROS 2 publisher?')\r\n\r\n        # Assertions\r\n        assert response['answer'] is not None\r\n        assert len(response['answer']) > 0\r\n        assert len(response['sources']) > 0\r\n        assert 'create_publisher' in response['answer'].lower()\r\n\r\n    def test_context_relevance(self, rag_pipeline):\r\n        \"\"\"Test that retrieved context is relevant to query.\"\"\"\r\n\r\n        query = \"What is SLAM?\"\r\n        response = rag_pipeline.query(query)\r\n\r\n        # Check that sources are relevant\r\n        for source in response['sources']:\r\n            assert source['relevance_score'] > 0.5\r\n            assert any(keyword in source['text'].lower()\r\n                      for keyword in ['slam', 'localization', 'mapping'])\n"})}),"\n",(0,s.jsx)(n.h2,{id:"simulation-integration-tests",children:"Simulation Integration Tests"}),"\n",(0,s.jsx)(n.h3,{id:"test-gazebo--ros-2-integration",children:"Test Gazebo + ROS 2 Integration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# test_gazebo_integration.py\r\nimport pytest\r\nimport subprocess\r\nimport time\r\nimport rclpy\r\nfrom geometry_msgs.msg import Twist\r\n\r\nclass TestGazeboIntegration:\r\n    @classmethod\r\n    def setup_class(cls):\r\n        """Launch Gazebo simulation."""\r\n        cls.gazebo_process = subprocess.Popen(\r\n            [\'gz\', \'sim\', \'test_world.sdf\', \'-s\'],  # Headless\r\n            stdout=subprocess.PIPE,\r\n            stderr=subprocess.PIPE\r\n        )\r\n        time.sleep(5)  # Wait for Gazebo to start\r\n        rclpy.init()\r\n\r\n    @classmethod\r\n    def teardown_class(cls):\r\n        """Stop Gazebo simulation."""\r\n        cls.gazebo_process.terminate()\r\n        cls.gazebo_process.wait()\r\n        rclpy.shutdown()\r\n\r\n    def test_robot_spawning(self):\r\n        """Test that robot can be spawned in Gazebo."""\r\n\r\n        # Spawn robot\r\n        result = subprocess.run(\r\n            [\'ros2\', \'service\', \'call\', \'/spawn_entity\',\r\n             \'gazebo_msgs/srv/SpawnEntity\',\r\n             \'{name: "test_robot", xml: "$(cat test_robot.urdf)"}\'],\r\n            capture_output=True,\r\n            text=True\r\n        )\r\n\r\n        assert result.returncode == 0\r\n        assert \'success\' in result.stdout.lower()\r\n\r\n    def test_robot_movement(self):\r\n        """Test robot responds to velocity commands."""\r\n\r\n        # Create velocity publisher\r\n        node = rclpy.create_node(\'test_movement\')\r\n        pub = node.create_publisher(Twist, \'/cmd_vel\', 10)\r\n\r\n        # Publish velocity command\r\n        msg = Twist()\r\n        msg.linear.x = 0.5\r\n        pub.publish(msg)\r\n\r\n        time.sleep(1)\r\n\r\n        # TODO: Verify robot moved (check /odom or /joint_states)\r\n\r\n        node.destroy_node()\n'})}),"\n",(0,s.jsx)(n.h2,{id:"continuous-integration-tests",children:"Continuous Integration Tests"}),"\n",(0,s.jsx)(n.h3,{id:"github-actions-workflow",children:"GitHub Actions Workflow"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# .github/workflows/integration-tests.yml\r\nname: Integration Tests\r\n\r\non:\r\n  push:\r\n    branches: [main, develop]\r\n  pull_request:\r\n\r\njobs:\r\n  test-ros2:\r\n    runs-on: ubuntu-22.04\r\n\r\n    steps:\r\n      - uses: actions/checkout@v3\r\n\r\n      - name: Setup ROS 2 Humble\r\n        uses: ros-tooling/setup-ros@v0.6\r\n        with:\r\n          required-ros-distributions: humble\r\n\r\n      - name: Install dependencies\r\n        run: |\r\n          sudo apt update\r\n          sudo apt install -y ros-humble-gazebo-ros-pkgs\r\n          pip3 install pytest pytest-asyncio\r\n\r\n      - name: Build workspace\r\n        run: |\r\n          source /opt/ros/humble/setup.bash\r\n          cd ros2_ws\r\n          colcon build\r\n\r\n      - name: Run integration tests\r\n        run: |\r\n          source /opt/ros/humble/setup.bash\r\n          source ros2_ws/install/setup.bash\r\n          pytest tests/integration/ -v\r\n\r\n  test-vla:\r\n    runs-on: ubuntu-22.04\r\n\r\n    steps:\r\n      - uses: actions/checkout@v3\r\n\r\n      - name: Setup Python\r\n        uses: actions/setup-python@v4\r\n        with:\r\n          python-version: '3.10'\r\n\r\n      - name: Install dependencies\r\n        run: |\r\n          pip install -r chatbot/requirements.txt\r\n          pip install pytest pytest-asyncio pytest-mock\r\n\r\n      - name: Run VLA tests\r\n        env:\r\n          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}\r\n          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}\r\n        run: |\r\n          pytest tests/vla/ -v\r\n\r\n  test-rag:\r\n    runs-on: ubuntu-22.04\r\n\r\n    steps:\r\n      - uses: actions/checkout@v3\r\n\r\n      - name: Setup Python\r\n        uses: actions/setup-python@v4\r\n        with:\r\n          python-version: '3.10'\r\n\r\n      - name: Install dependencies\r\n        run: |\r\n          pip install -r chatbot/requirements.txt\r\n          pip install pytest pytest-asyncio\r\n\r\n      - name: Run RAG tests\r\n        env:\r\n          QDRANT_URL: ${{ secrets.QDRANT_TEST_URL }}\r\n          QDRANT_API_KEY: ${{ secrets.QDRANT_API_KEY }}\r\n          DATABASE_URL: ${{ secrets.DATABASE_TEST_URL }}\r\n          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}\r\n          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}\r\n        run: |\r\n          pytest tests/rag/ -v\n"})}),"\n",(0,s.jsx)(n.h2,{id:"load-testing",children:"Load Testing"}),"\n",(0,s.jsx)(n.h3,{id:"test-api-performance",children:"Test API Performance"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# test_load.py\r\nimport asyncio\r\nimport aiohttp\r\nimport time\r\nfrom statistics import mean, median\r\n\r\nasync def load_test_chatbot(num_requests=100):\r\n    """Load test the chatbot API."""\r\n\r\n    async def send_query(session, query):\r\n        start = time.time()\r\n        async with session.post(\r\n            \'http://localhost:8000/chat\',\r\n            json={\'query\': query}\r\n        ) as response:\r\n            await response.json()\r\n            return time.time() - start\r\n\r\n    queries = [\r\n        "How do I create a ROS 2 publisher?",\r\n        "What is SLAM?",\r\n        "Explain Nav2 navigation",\r\n    ] * (num_requests // 3)\r\n\r\n    async with aiohttp.ClientSession() as session:\r\n        tasks = [send_query(session, q) for q in queries]\r\n        response_times = await asyncio.gather(*tasks)\r\n\r\n    # Print statistics\r\n    print(f"Total requests: {num_requests}")\r\n    print(f"Mean response time: {mean(response_times):.2f}s")\r\n    print(f"Median response time: {median(response_times):.2f}s")\r\n    print(f"Min response time: {min(response_times):.2f}s")\r\n    print(f"Max response time: {max(response_times):.2f}s")\r\n\r\n# Run load test\r\nasyncio.run(load_test_chatbot(100))\n'})}),"\n",(0,s.jsx)(n.h2,{id:"test-coverage",children:"Test Coverage"}),"\n",(0,s.jsx)(n.h3,{id:"generate-coverage-report",children:"Generate Coverage Report"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Run tests with coverage\r\npytest --cov=app --cov-report=html tests/\r\n\r\n# View coverage report\r\nopen htmlcov/index.html\r\n\r\n# Target: 80%+ coverage\n"})}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Isolate Tests"}),": Each test should be independent"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use Fixtures"}),": Reuse common setup code"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Mock External APIs"}),": Don't call real APIs in tests"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Test Edge Cases"}),": Not just happy paths"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Fast Tests"}),": Keep test suite under 5 minutes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Meaningful Assertions"}),": Test behavior, not implementation"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Intermediate/Testing/Testing-Main.html",children:"ROS 2 Testing Guide"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.pytest.org/",children:"pytest Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://fastapi.tiangolo.com/tutorial/testing/",children:"FastAPI Testing"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>a});var t=r(6540);const s={},i=t.createContext(s);function o(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);