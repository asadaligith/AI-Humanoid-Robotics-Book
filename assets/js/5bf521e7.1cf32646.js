"use strict";(self.webpackChunkai_humanoid_robotics_book=self.webpackChunkai_humanoid_robotics_book||[]).push([[7314],{5418:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"rag-chatbot/deployment","title":"RAG Chatbot Deployment Guide","description":"Overview","source":"@site/docs/rag-chatbot/deployment.md","sourceDirName":"rag-chatbot","slug":"/rag-chatbot/deployment","permalink":"/docs/rag-chatbot/deployment","draft":false,"unlisted":false,"editUrl":"https://github.com/asadaligith/AI-Humanoid-Robotics-Book/tree/main/docs/rag-chatbot/deployment.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"RAG Chatbot Setup Guide","permalink":"/docs/rag-chatbot/setup"},"next":{"title":"API Integration Reference","permalink":"/docs/integrations/api-reference"}}');var s=r(4848),i=r(8453);const a={},o="RAG Chatbot Deployment Guide",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Deployment Options",id:"deployment-options",level:2},{value:"Option 1: Cloud Platform (Recommended)",id:"option-1-cloud-platform-recommended",level:3},{value:"Option 2: Self-Hosted",id:"option-2-self-hosted",level:3},{value:"Option 3: Serverless",id:"option-3-serverless",level:3},{value:"Production Deployment (Railway)",id:"production-deployment-railway",level:2},{value:"Step 1: Prepare Application",id:"step-1-prepare-application",level:3},{value:"Step 2: Environment Variables",id:"step-2-environment-variables",level:3},{value:"Step 3: Deploy",id:"step-3-deploy",level:3},{value:"Docker Production Deployment",id:"docker-production-deployment",level:2},{value:"Multi-Stage Dockerfile",id:"multi-stage-dockerfile",level:3},{value:"Docker Compose for Production",id:"docker-compose-for-production",level:3},{value:"Nginx Configuration",id:"nginx-configuration",level:3},{value:"CI/CD with GitHub Actions",id:"cicd-with-github-actions",level:2},{value:"Monitoring &amp; Logging",id:"monitoring--logging",level:2},{value:"Application Logging",id:"application-logging",level:3},{value:"Sentry Integration",id:"sentry-integration",level:3},{value:"Prometheus Metrics",id:"prometheus-metrics",level:3},{value:"Scaling Strategies",id:"scaling-strategies",level:2},{value:"Horizontal Scaling",id:"horizontal-scaling",level:3},{value:"Load Balancing",id:"load-balancing",level:3},{value:"Caching Layer",id:"caching-layer",level:3},{value:"Security Hardening",id:"security-hardening",level:2},{value:"API Key Rotation",id:"api-key-rotation",level:3},{value:"Input Sanitization",id:"input-sanitization",level:3},{value:"Backup &amp; Recovery",id:"backup--recovery",level:2},{value:"Database Backups",id:"database-backups",level:3},{value:"Vector Database Backup",id:"vector-database-backup",level:3},{value:"Cost Optimization",id:"cost-optimization",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"High Latency",id:"high-latency",level:3},{value:"Memory Leaks",id:"memory-leaks",level:3},{value:"Database Connection Issues",id:"database-connection-issues",level:3},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"rag-chatbot-deployment-guide",children:"RAG Chatbot Deployment Guide"})}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"This guide covers deploying the RAG chatbot to production using Docker, cloud services, and CI/CD automation."}),"\n",(0,s.jsx)(n.h2,{id:"deployment-options",children:"Deployment Options"}),"\n",(0,s.jsx)(n.h3,{id:"option-1-cloud-platform-recommended",children:"Option 1: Cloud Platform (Recommended)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"API"}),": Railway, Render, or Fly.io"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Database"}),": Neon PostgreSQL (serverless)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Vector DB"}),": Qdrant Cloud"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"CDN"}),": Cloudflare (for static site)"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"option-2-self-hosted",children:"Option 2: Self-Hosted"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Server"}),": AWS EC2, DigitalOcean, or VPS"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Database"}),": Self-hosted PostgreSQL"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Vector DB"}),": Self-hosted Qdrant"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Reverse Proxy"}),": Nginx"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"option-3-serverless",children:"Option 3: Serverless"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Functions"}),": AWS Lambda or Cloudflare Workers"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"API Gateway"}),": AWS API Gateway"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Database"}),": Neon PostgreSQL"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Vector DB"}),": Qdrant Cloud"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"production-deployment-railway",children:"Production Deployment (Railway)"}),"\n",(0,s.jsx)(n.h3,{id:"step-1-prepare-application",children:"Step 1: Prepare Application"}),"\n",(0,s.jsxs)(n.p,{children:["Create ",(0,s.jsx)(n.code,{children:"railway.json"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\r\n  "$schema": "https://railway.app/railway.schema.json",\r\n  "build": {\r\n    "builder": "NIXPACKS",\r\n    "buildCommand": "pip install -r requirements.txt"\r\n  },\r\n  "deploy": {\r\n    "startCommand": "uvicorn app.main:app --host 0.0.0.0 --port $PORT",\r\n    "restartPolicyType": "ON_FAILURE",\r\n    "restartPolicyMaxRetries": 10\r\n  }\r\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"step-2-environment-variables",children:"Step 2: Environment Variables"}),"\n",(0,s.jsx)(n.p,{children:"Set in Railway dashboard:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ANTHROPIC_API_KEY=sk-ant-...\r\nOPENAI_API_KEY=sk-...\r\nQDRANT_URL=https://xxx.qdrant.io:6333\r\nQDRANT_API_KEY=...\r\nDATABASE_URL=postgresql://...\r\nAPP_ENV=production\r\nLOG_LEVEL=INFO\r\nALLOWED_ORIGINS=https://yourdomain.com\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-3-deploy",children:"Step 3: Deploy"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Install Railway CLI\r\nnpm install -g @railway/cli\r\n\r\n# Login\r\nrailway login\r\n\r\n# Initialize project\r\nrailway init\r\n\r\n# Deploy\r\nrailway up\r\n\r\n# Add custom domain\r\nrailway domain\n"})}),"\n",(0,s.jsx)(n.h2,{id:"docker-production-deployment",children:"Docker Production Deployment"}),"\n",(0,s.jsx)(n.h3,{id:"multi-stage-dockerfile",children:"Multi-Stage Dockerfile"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'# Build stage\r\nFROM python:3.11-slim as builder\r\n\r\nWORKDIR /app\r\n\r\n# Install build dependencies\r\nRUN apt-get update && apt-get install -y \\\r\n    gcc \\\r\n    postgresql-client \\\r\n    && rm -rf /var/lib/apt/lists/*\r\n\r\n# Install Python dependencies\r\nCOPY requirements.txt .\r\nRUN pip install --user --no-cache-dir -r requirements.txt\r\n\r\n# Runtime stage\r\nFROM python:3.11-slim\r\n\r\nWORKDIR /app\r\n\r\n# Copy Python packages from builder\r\nCOPY --from=builder /root/.local /root/.local\r\n\r\n# Copy application\r\nCOPY app/ ./app/\r\n\r\n# Create non-root user\r\nRUN useradd -m -u 1000 appuser && \\\r\n    chown -R appuser:appuser /app\r\n\r\nUSER appuser\r\n\r\n# Update PATH\r\nENV PATH=/root/.local/bin:$PATH\r\n\r\n# Expose port\r\nEXPOSE 8000\r\n\r\n# Health check\r\nHEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\r\n  CMD python -c "import requests; requests.get(\'http://localhost:8000/health\')"\r\n\r\n# Run application\r\nCMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000", "--workers", "4"]\n'})}),"\n",(0,s.jsx)(n.h3,{id:"docker-compose-for-production",children:"Docker Compose for Production"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'version: \'3.8\'\r\n\r\nservices:\r\n  chatbot-api:\r\n    build:\r\n      context: .\r\n      dockerfile: Dockerfile\r\n    ports:\r\n      - "8000:8000"\r\n    environment:\r\n      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}\r\n      - OPENAI_API_KEY=${OPENAI_API_KEY}\r\n      - QDRANT_URL=${QDRANT_URL}\r\n      - QDRANT_API_KEY=${QDRANT_API_KEY}\r\n      - DATABASE_URL=${DATABASE_URL}\r\n      - REDIS_URL=redis://redis:6379/0\r\n      - APP_ENV=production\r\n    depends_on:\r\n      - redis\r\n    restart: unless-stopped\r\n    healthcheck:\r\n      test: ["CMD", "curl", "-f", "http://localhost:8000/health"]\r\n      interval: 30s\r\n      timeout: 10s\r\n      retries: 3\r\n\r\n  redis:\r\n    image: redis:7-alpine\r\n    volumes:\r\n      - redis_data:/data\r\n    restart: unless-stopped\r\n    healthcheck:\r\n      test: ["CMD", "redis-cli", "ping"]\r\n      interval: 30s\r\n      timeout: 10s\r\n      retries: 3\r\n\r\n  nginx:\r\n    image: nginx:alpine\r\n    ports:\r\n      - "80:80"\r\n      - "443:443"\r\n    volumes:\r\n      - ./nginx.conf:/etc/nginx/nginx.conf:ro\r\n      - ./ssl:/etc/nginx/ssl:ro\r\n    depends_on:\r\n      - chatbot-api\r\n    restart: unless-stopped\r\n\r\nvolumes:\r\n  redis_data:\n'})}),"\n",(0,s.jsx)(n.h3,{id:"nginx-configuration",children:"Nginx Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'# nginx.conf\r\nupstream chatbot_api {\r\n    server chatbot-api:8000;\r\n}\r\n\r\nserver {\r\n    listen 80;\r\n    server_name api.yourdomain.com;\r\n\r\n    # Redirect to HTTPS\r\n    return 301 https://$server_name$request_uri;\r\n}\r\n\r\nserver {\r\n    listen 443 ssl http2;\r\n    server_name api.yourdomain.com;\r\n\r\n    # SSL certificates\r\n    ssl_certificate /etc/nginx/ssl/fullchain.pem;\r\n    ssl_certificate_key /etc/nginx/ssl/privkey.pem;\r\n\r\n    # SSL configuration\r\n    ssl_protocols TLSv1.2 TLSv1.3;\r\n    ssl_ciphers HIGH:!aNULL:!MD5;\r\n    ssl_prefer_server_ciphers on;\r\n\r\n    # Security headers\r\n    add_header X-Frame-Options "SAMEORIGIN" always;\r\n    add_header X-Content-Type-Options "nosniff" always;\r\n    add_header X-XSS-Protection "1; mode=block" always;\r\n    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;\r\n\r\n    # CORS headers\r\n    add_header Access-Control-Allow-Origin "https://yourdomain.com" always;\r\n    add_header Access-Control-Allow-Methods "GET, POST, OPTIONS" always;\r\n    add_header Access-Control-Allow-Headers "Content-Type, Authorization" always;\r\n\r\n    # Rate limiting\r\n    limit_req_zone $binary_remote_addr zone=api_limit:10m rate=10r/m;\r\n\r\n    location / {\r\n        limit_req zone=api_limit burst=20 nodelay;\r\n\r\n        proxy_pass http://chatbot_api;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n        proxy_set_header X-Forwarded-Proto $scheme;\r\n\r\n        # Timeouts\r\n        proxy_connect_timeout 60s;\r\n        proxy_send_timeout 60s;\r\n        proxy_read_timeout 60s;\r\n    }\r\n\r\n    location /health {\r\n        proxy_pass http://chatbot_api/health;\r\n        access_log off;\r\n    }\r\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"cicd-with-github-actions",children:"CI/CD with GitHub Actions"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# .github/workflows/deploy.yml\r\nname: Deploy to Production\r\n\r\non:\r\n  push:\r\n    branches: [main]\r\n  workflow_dispatch:\r\n\r\njobs:\r\n  deploy:\r\n    runs-on: ubuntu-latest\r\n\r\n    steps:\r\n      - name: Checkout code\r\n        uses: actions/checkout@v3\r\n\r\n      - name: Set up Python\r\n        uses: actions/setup-python@v4\r\n        with:\r\n          python-version: '3.11'\r\n\r\n      - name: Install dependencies\r\n        run: |\r\n          cd chatbot\r\n          pip install -r requirements.txt\r\n          pip install pytest pytest-asyncio\r\n\r\n      - name: Run tests\r\n        run: |\r\n          cd chatbot\r\n          pytest tests/\r\n\r\n      - name: Build Docker image\r\n        run: |\r\n          cd chatbot\r\n          docker build -t chatbot-api:latest .\r\n\r\n      - name: Login to Docker Hub\r\n        uses: docker/login-action@v2\r\n        with:\r\n          username: ${{ secrets.DOCKER_USERNAME }}\r\n          password: ${{ secrets.DOCKER_PASSWORD }}\r\n\r\n      - name: Push to Docker Hub\r\n        run: |\r\n          docker tag chatbot-api:latest ${{ secrets.DOCKER_USERNAME }}/chatbot-api:latest\r\n          docker push ${{ secrets.DOCKER_USERNAME }}/chatbot-api:latest\r\n\r\n      - name: Deploy to Railway\r\n        run: |\r\n          npm install -g @railway/cli\r\n          railway up --service chatbot-api\r\n        env:\r\n          RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}\r\n\r\n      - name: Run database migrations\r\n        run: |\r\n          python chatbot/scripts/migrate_database.py\r\n        env:\r\n          DATABASE_URL: ${{ secrets.DATABASE_URL }}\r\n\r\n      - name: Ingest latest documentation\r\n        run: |\r\n          python chatbot/scripts/ingest_docs.py --docs-path docs\r\n        env:\r\n          QDRANT_URL: ${{ secrets.QDRANT_URL }}\r\n          QDRANT_API_KEY: ${{ secrets.QDRANT_API_KEY }}\r\n          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}\r\n          DATABASE_URL: ${{ secrets.DATABASE_URL }}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"monitoring--logging",children:"Monitoring & Logging"}),"\n",(0,s.jsx)(n.h3,{id:"application-logging",children:"Application Logging"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# app/logging_config.py\r\nimport logging\r\nfrom logging.handlers import RotatingFileHandler\r\nimport sys\r\n\r\ndef setup_logging(app_env="production"):\r\n    """Configure application logging."""\r\n\r\n    # Create logger\r\n    logger = logging.getLogger("chatbot")\r\n    logger.setLevel(logging.INFO if app_env == "production" else logging.DEBUG)\r\n\r\n    # Console handler\r\n    console_handler = logging.StreamHandler(sys.stdout)\r\n    console_handler.setLevel(logging.INFO)\r\n\r\n    # File handler (rotating)\r\n    file_handler = RotatingFileHandler(\r\n        "logs/chatbot.log",\r\n        maxBytes=10 * 1024 * 1024,  # 10MB\r\n        backupCount=5\r\n    )\r\n    file_handler.setLevel(logging.DEBUG)\r\n\r\n    # Formatter\r\n    formatter = logging.Formatter(\r\n        \'%(asctime)s - %(name)s - %(levelname)s - %(message)s\'\r\n    )\r\n    console_handler.setFormatter(formatter)\r\n    file_handler.setFormatter(formatter)\r\n\r\n    # Add handlers\r\n    logger.addHandler(console_handler)\r\n    logger.addHandler(file_handler)\r\n\r\n    return logger\n'})}),"\n",(0,s.jsx)(n.h3,{id:"sentry-integration",children:"Sentry Integration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import sentry_sdk\r\nfrom sentry_sdk.integrations.fastapi import FastApiIntegration\r\n\r\nsentry_sdk.init(\r\n    dsn=os.getenv("SENTRY_DSN"),\r\n    integrations=[FastApiIntegration()],\r\n    traces_sample_rate=0.1,\r\n    environment=os.getenv("APP_ENV", "production")\r\n)\n'})}),"\n",(0,s.jsx)(n.h3,{id:"prometheus-metrics",children:"Prometheus Metrics"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from prometheus_client import Counter, Histogram, Gauge, generate_latest\r\nfrom fastapi import Response\r\n\r\n# Metrics\r\nrequest_count = Counter('chatbot_requests_total', 'Total requests')\r\nrequest_duration = Histogram('chatbot_request_duration_seconds', 'Request duration')\r\nactive_sessions = Gauge('chatbot_active_sessions', 'Active sessions')\r\n\r\n@app.get(\"/metrics\")\r\nasync def metrics():\r\n    \"\"\"Prometheus metrics endpoint.\"\"\"\r\n    return Response(content=generate_latest(), media_type=\"text/plain\")\n"})}),"\n",(0,s.jsx)(n.h2,{id:"scaling-strategies",children:"Scaling Strategies"}),"\n",(0,s.jsx)(n.h3,{id:"horizontal-scaling",children:"Horizontal Scaling"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# docker-compose.scale.yml\r\nservices:\r\n  chatbot-api:\r\n    deploy:\r\n      replicas: 4\r\n      resources:\r\n        limits:\r\n          cpus: '1'\r\n          memory: 2G\r\n        reservations:\r\n          cpus: '0.5'\r\n          memory: 1G\n"})}),"\n",(0,s.jsx)(n.h3,{id:"load-balancing",children:"Load Balancing"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"upstream chatbot_api {\r\n    least_conn;\r\n    server chatbot-api-1:8000 weight=1;\r\n    server chatbot-api-2:8000 weight=1;\r\n    server chatbot-api-3:8000 weight=1;\r\n    server chatbot-api-4:8000 weight=1;\r\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"caching-layer",children:"Caching Layer"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import redis\r\nfrom functools import wraps\r\nimport json\r\nimport hashlib\r\n\r\nredis_client = redis.Redis.from_url(os.getenv("REDIS_URL"))\r\n\r\ndef cache_query(ttl=3600):\r\n    """Cache query results in Redis."""\r\n    def decorator(func):\r\n        @wraps(func)\r\n        async def wrapper(query: str, *args, **kwargs):\r\n            # Create cache key\r\n            cache_key = f"query:{hashlib.sha256(query.encode()).hexdigest()}"\r\n\r\n            # Check cache\r\n            cached = redis_client.get(cache_key)\r\n            if cached:\r\n                return json.loads(cached)\r\n\r\n            # Execute query\r\n            result = await func(query, *args, **kwargs)\r\n\r\n            # Cache result\r\n            redis_client.setex(cache_key, ttl, json.dumps(result))\r\n\r\n            return result\r\n        return wrapper\r\n    return decorator\n'})}),"\n",(0,s.jsx)(n.h2,{id:"security-hardening",children:"Security Hardening"}),"\n",(0,s.jsx)(n.h3,{id:"api-key-rotation",children:"API Key Rotation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# Rotate API keys periodically\r\nimport boto3\r\n\r\ndef rotate_api_keys():\r\n    """Rotate API keys stored in AWS Secrets Manager."""\r\n    secrets = boto3.client(\'secretsmanager\')\r\n\r\n    # Generate new keys\r\n    # Update in Secrets Manager\r\n    # Update in application config\r\n    # Revoke old keys\n'})}),"\n",(0,s.jsx)(n.h3,{id:"input-sanitization",children:"Input Sanitization"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from fastapi import HTTPException\r\nimport re\r\n\r\ndef sanitize_query(query: str) -> str:\r\n    \"\"\"Sanitize user query.\"\"\"\r\n    # Remove control characters\r\n    query = re.sub(r'[\\x00-\\x1f\\x7f-\\x9f]', '', query)\r\n\r\n    # Limit length\r\n    if len(query) > 1000:\r\n        raise HTTPException(status_code=400, detail=\"Query too long\")\r\n\r\n    # Check for injection attempts\r\n    dangerous_patterns = [\r\n        r'<script',\r\n        r'javascript:',\r\n        r'onerror=',\r\n        r'onclick='\r\n    ]\r\n\r\n    for pattern in dangerous_patterns:\r\n        if re.search(pattern, query, re.IGNORECASE):\r\n            raise HTTPException(status_code=400, detail=\"Invalid query\")\r\n\r\n    return query.strip()\n"})}),"\n",(0,s.jsx)(n.h2,{id:"backup--recovery",children:"Backup & Recovery"}),"\n",(0,s.jsx)(n.h3,{id:"database-backups",children:"Database Backups"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Automated daily backups\r\n#!/bin/bash\r\n# backup.sh\r\n\r\nDATE=$(date +%Y%m%d_%H%M%S)\r\nBACKUP_DIR="/backups"\r\nDATABASE_URL="postgresql://..."\r\n\r\n# Backup PostgreSQL\r\npg_dump "$DATABASE_URL" | gzip > "$BACKUP_DIR/db_$DATE.sql.gz"\r\n\r\n# Upload to S3\r\naws s3 cp "$BACKUP_DIR/db_$DATE.sql.gz" s3://my-backups/chatbot/\r\n\r\n# Keep only last 30 days\r\nfind "$BACKUP_DIR" -name "db_*.sql.gz" -mtime +30 -delete\n'})}),"\n",(0,s.jsx)(n.h3,{id:"vector-database-backup",children:"Vector Database Backup"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# Export Qdrant snapshot\r\nfrom qdrant_client import QdrantClient\r\n\r\nclient = QdrantClient(url=QDRANT_URL, api_key=QDRANT_API_KEY)\r\n\r\n# Create snapshot\r\nclient.create_snapshot(collection_name="course_docs")\r\n\r\n# Download snapshot\r\n# Upload to cloud storage\n'})}),"\n",(0,s.jsx)(n.h2,{id:"cost-optimization",children:"Cost Optimization"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use Connection Pooling"}),": Reduce database connections"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cache Frequent Queries"}),": Redis for hot data"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Batch Embeddings"}),": Group API calls"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Right-Size Instances"}),": Monitor and adjust resources"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use Spot Instances"}),": For non-critical workloads"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.h3,{id:"high-latency",children:"High Latency"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check database query performance\r\nEXPLAIN ANALYZE SELECT * FROM documents WHERE module = '01';\r\n\r\n# Add missing indexes\r\nCREATE INDEX idx_documents_module ON documents(module);\r\n\r\n# Monitor API response times\r\ntail -f logs/chatbot.log | grep \"response_time\"\n"})}),"\n",(0,s.jsx)(n.h3,{id:"memory-leaks",children:"Memory Leaks"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# Use memory profiler\r\nfrom memory_profiler import profile\r\n\r\n@profile\r\ndef process_query(query):\r\n    # Your code here\r\n    pass\n"})}),"\n",(0,s.jsx)(n.h3,{id:"database-connection-issues",children:"Database Connection Issues"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# Implement connection retry\r\nfrom tenacity import retry, stop_after_attempt, wait_fixed\r\n\r\n@retry(stop=stop_after_attempt(3), wait=wait_fixed(2))\r\ndef get_db_connection():\r\n    return psycopg2.connect(DATABASE_URL)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.railway.app/",children:"Railway Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.docker.com/develop/dev-best-practices/",children:"Docker Best Practices"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.nginx.com/resources/wiki/",children:"Nginx Configuration"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://fastapi.tiangolo.com/deployment/",children:"FastAPI Deployment"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>o});var t=r(6540);const s={},i=t.createContext(s);function a(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);