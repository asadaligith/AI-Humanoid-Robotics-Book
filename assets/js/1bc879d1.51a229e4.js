"use strict";(self.webpackChunkai_humanoid_robotics_book=self.webpackChunkai_humanoid_robotics_book||[]).push([[3158],{4642:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"modules/module-01-ros2-fundamentals/chapter-05-actions","title":"Chapter 5: Actions for Long-Running Tasks","description":"Implement goal-based asynchronous tasks with feedback using ROS 2 actions","source":"@site/docs/modules/module-01-ros2-fundamentals/chapter-05-actions.md","sourceDirName":"modules/module-01-ros2-fundamentals","slug":"/modules/module-01-ros2-fundamentals/chapter-05-actions","permalink":"/docs/modules/module-01-ros2-fundamentals/chapter-05-actions","draft":false,"unlisted":false,"editUrl":"https://github.com/asadaligith/AI-Humanoid-Robotics-Book/tree/main/docs/modules/module-01-ros2-fundamentals/chapter-05-actions.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Chapter 5: Actions for Long-Running Tasks","description":"Implement goal-based asynchronous tasks with feedback using ROS 2 actions","sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"4\ufe0f\u20e3 Services","permalink":"/docs/modules/module-01-ros2-fundamentals/chapter-04-services"},"next":{"title":"6\ufe0f\u20e3 URDF & TF2","permalink":"/docs/modules/module-01-ros2-fundamentals/chapter-06-urdf-tf"}}');var i=s(4848),t=s(8453);const o={title:"Chapter 5: Actions for Long-Running Tasks",description:"Implement goal-based asynchronous tasks with feedback using ROS 2 actions",sidebar_position:5},c="Chapter 5: Actions for Long-Running Tasks",a={},l=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Introduction",id:"introduction",level:2},{value:"Action Structure",id:"action-structure",level:2},{value:"When to Use Actions",id:"when-to-use-actions",level:2},{value:"Action Server Example",id:"action-server-example",level:2},{value:"Action Client Example",id:"action-client-example",level:2},{value:"Custom Action Definitions",id:"custom-action-definitions",level:2},{value:"Testing Actions",id:"testing-actions",level:2},{value:"Exercise",id:"exercise",level:2},{value:"Summary",id:"summary",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",strong:"strong",sup:"sup",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"chapter-5-actions-for-long-running-tasks",children:"Chapter 5: Actions for Long-Running Tasks"})}),"\n",(0,i.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,i.jsx)(n.p,{children:"By the end of this chapter, you will be able to:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Create"})," ROS 2 action servers for long-running tasks"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Implement"})," action clients with goal handling and feedback"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Design"})," custom action definitions for robotics workflows"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Monitor"})," action execution with feedback and result callbacks"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsxs)(n.p,{children:["Actions combine the best of topics and services: asynchronous execution like topics, bidirectional communication like services, plus periodic feedback and cancel ability",(0,i.jsx)(n.sup,{children:(0,i.jsx)(n.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"action-structure",children:"Action Structure"}),"\n",(0,i.jsx)(n.p,{children:"An action consists of three parts:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Goal"}),": Request to start the task"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Feedback"}),": Periodic progress updates"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Result"}),": Final outcome when complete"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"when-to-use-actions",children:"When to Use Actions"}),"\n",(0,i.jsxs)(n.p,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"Use actions for"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Navigation (send goal pose, get progress feedback)"}),"\n",(0,i.jsx)(n.li,{children:"Manipulation (grasp object, report grasping stages)"}),"\n",(0,i.jsx)(n.li,{children:"Long computations (path planning with incremental results)"}),"\n",(0,i.jsx)(n.li,{children:"Preemptable tasks (ability to cancel mid-execution)"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"action-server-example",children:"Action Server Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.action import ActionServer\r\nfrom rclpy.node import Node\r\nfrom action_tutorials_interfaces.action import Fibonacci\r\n\r\nclass FibonacciServer(Node):\r\n    def __init__(self):\r\n        super().__init__('fibonacci_server')\r\n        self._action_server = ActionServer(\r\n            self,\r\n            Fibonacci,\r\n            'fibonacci',\r\n            self.execute_callback\r\n        )\r\n\r\n    def execute_callback(self, goal_handle):\r\n        self.get_logger().info('Executing goal...')\r\n\r\n        feedback_msg = Fibonacci.Feedback()\r\n        feedback_msg.sequence = [0, 1]\r\n\r\n        for i in range(1, goal_handle.request.order):\r\n            feedback_msg.sequence.append(\r\n                feedback_msg.sequence[i] + feedback_msg.sequence[i-1]\r\n            )\r\n            goal_handle.publish_feedback(feedback_msg)\r\n\r\n        goal_handle.succeed()\r\n        result = Fibonacci.Result()\r\n        result.sequence = feedback_msg.sequence\r\n        return result\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = FibonacciServer()\r\n    rclpy.spin(node)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"action-client-example",children:"Action Client Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.action import ActionClient\r\nfrom rclpy.node import Node\r\nfrom action_tutorials_interfaces.action import Fibonacci\r\n\r\nclass FibonacciClient(Node):\r\n    def __init__(self):\r\n        super().__init__('fibonacci_client')\r\n        self._action_client = ActionClient(self, Fibonacci, 'fibonacci')\r\n\r\n    def send_goal(self, order):\r\n        goal_msg = Fibonacci.Goal()\r\n        goal_msg.order = order\r\n\r\n        self._action_client.wait_for_server()\r\n        self._send_goal_future = self._action_client.send_goal_async(\r\n            goal_msg,\r\n            feedback_callback=self.feedback_callback\r\n        )\r\n        self._send_goal_future.add_done_callback(self.goal_response_callback)\r\n\r\n    def feedback_callback(self, feedback_msg):\r\n        feedback = feedback_msg.feedback\r\n        self.get_logger().info(f'Feedback: {feedback.sequence}')\r\n\r\n    def goal_response_callback(self, future):\r\n        goal_handle = future.result()\r\n        if not goal_handle.accepted:\r\n            self.get_logger().info('Goal rejected')\r\n            return\r\n\r\n        self.get_logger().info('Goal accepted')\r\n        self._get_result_future = goal_handle.get_result_async()\r\n        self._get_result_future.add_done_callback(self.get_result_callback)\r\n\r\n    def get_result_callback(self, future):\r\n        result = future.result().result\r\n        self.get_logger().info(f'Result: {result.sequence}')\n"})}),"\n",(0,i.jsx)(n.h2,{id:"custom-action-definitions",children:"Custom Action Definitions"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"File"}),": ",(0,i.jsx)(n.code,{children:"my_interfaces/action/NavigateToGoal.action"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# Goal\r\ngeometry_msgs/PoseStamped target_pose\r\n---\r\n# Result\r\nbool success\r\nfloat32 total_distance\r\n---\r\n# Feedback\r\ngeometry_msgs/PoseStamped current_pose\r\nfloat32 distance_remaining\n"})}),"\n",(0,i.jsx)(n.h2,{id:"testing-actions",children:"Testing Actions"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# List available actions\r\nros2 action list\r\n\r\n# Send goal from CLI\r\nros2 action send_goal /fibonacci action_tutorials_interfaces/action/Fibonacci "{order: 5}" --feedback\r\n\r\n# Show action info\r\nros2 action info /fibonacci\n'})}),"\n",(0,i.jsx)(n.h2,{id:"exercise",children:"Exercise"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Task"}),': Create a "battery charge" action where:']}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Goal: Target charge percentage (e.g., 80%)"}),"\n",(0,i.jsx)(n.li,{children:"Feedback: Current charge percentage every second"}),"\n",(0,i.jsx)(n.li,{children:"Result: Final charge level and time taken"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Code Example"}),": See ",(0,i.jsx)(n.code,{children:"examples/module-01-ros2-fundamentals/example-04-action/"})]}),"\n",(0,i.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(n.p,{children:"Actions provide goal-oriented, long-running tasks with feedback and cancellation capabilities."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Next"}),": ",(0,i.jsx)(n.a,{href:"/docs/modules/module-01-ros2-fundamentals/chapter-06-urdf-tf",children:"Chapter 6: Robot Modeling with URDF & TF2"})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Estimated Reading Time"}),": 20 minutes\r\n",(0,i.jsx)(n.strong,{children:"Hands-On Time"}),": 45 minutes"]}),"\n","\n",(0,i.jsxs)(n.section,{"data-footnotes":!0,className:"footnotes",children:[(0,i.jsx)(n.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{id:"user-content-fn-1",children:["\n",(0,i.jsxs)(n.p,{children:['ROS 2 Documentation. "Understanding Actions." ',(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Actions/Understanding-ROS2-Actions.html",children:"https://docs.ros.org/en/humble/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Actions/Understanding-ROS2-Actions.html"})," ",(0,i.jsx)(n.a,{href:"#user-content-fnref-1","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var r=s(6540);const i={},t=r.createContext(i);function o(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);